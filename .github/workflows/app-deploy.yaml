name: Google App Engine Deploy

on:
    pull_request:
        branches: [master]
    push:
        branches: [master]

jobs:
    deploy_app:
        permissions:
            contents: 'read'
            id-token: 'write'
        runs-on: ubuntu-latest
        steps:
            - id: "checkout"
              uses: actions/checkout@v2

            - id: 'auth'
              uses: 'google-github-actions/auth@v0'
              with:
              
                  credentials_json: '${{ secrets.GOOGLE_SERVICE_ACC_KEY }}'

            - id: 'deploy'
              uses: 'google-github-actions/deploy-appengine@v0'

              with:
                deliverables: 'app.yaml'
                project_id: '${{ secrets.GCP_PROJECT }}'